<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Lab 7 - Genome-wide association study &middot; BIT150
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/BIT150_website/public/css/poole.css">
  <link rel="stylesheet" href="/BIT150_website/public/css/syntax.css">
  <link rel="stylesheet" href="/BIT150_website/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="logo" sizes="144x144" href="/BIT150_website/public/logo.png">
  <link rel="shortcut icon" href="/BIT150_website/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0g">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" checked>

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <h1>
      <a href="/BIT150_website/">
        BIT150
      </a>
    </h1>
    <p class="lead">The UC Davis - CAES course for the development of fundamental skills in Bioinformatics</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/BIT150_website/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/BIT150_website/about/">About</a>
        
      
    
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/BIT150_website/course_syllabus/">BIT 150 Syllabus - Fall 2017</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/BIT150_website/discussions/">Discussions</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/BIT150_website/labs/">Labs</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/BIT150_website/projects/">Projects</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/BIT150_website/schedule/">Schedule</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/BIT150_website/supplement/">Supplemental Material</a>
        
      
    

<!--
    <a class="sidebar-nav-item" href="/archive/v1.0.0.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
-->
    <span class="sidebar-nav-item">Currently v1.0.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2017, DE Runcie & SM Higdon. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/BIT150_website/" title="Home">BIT150</a>
            <small>Applied Bioinformatics</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Lab 7 - Genome-wide association study</h1>
  <span class="post-date">09 Nov 2017</span>
  <div class="lab">
  <h1 id="goals">Goals</h1>

<ol>
  <li>Use the GWAS Catalog to find variants associated with specific traits</li>
  <li>Understand statistics reported in GWAS studies</li>
  <li>Predict the functional effects of specific allelic variants</li>
</ol>

<h1 id="activity">Activity</h1>

<h2 id="introduction-to-gwas-catalog">Introduction to GWAS Catalog</h2>

<ol>
  <li>Go to: <a href="https://www.ebi.ac.uk/gwas/">GWAS Catalog</a>
    <blockquote>
      <p>The GWAS Catalog is operated by the National Human Genome Research Institute and the European Bioinformatics Institute. The Catalog is a quality controlled, manually curated, collection of all published genome-wide association studies assaying at least 100,000 SNPs and all SNP-trait associations with p-values &lt; 1.0 x 10<sup>-5</sup>. In plant there is similar GWAS Catelog in <em>Arabidopsis</em></p>

      <p>ex:</p>

      <ul>
        <li><a href="https://aragwas.1001genomes.org">AraGWAS</a> developed within the <em>Arabidopsis</em> 1001 Genome project</li>
      </ul>
    </blockquote>
  </li>
  <li>Click on <strong>Diagram</strong>.
    <blockquote>
      <p>This diagram shows all SNP-trait associations with p-value ≤ 5.0 × 10<sup>-8</sup>. You can view the SNP distribution by filtering different types of phenotypes, for example: cardiovascular disease, response to drugs, or you can type any thing in the blank space <strong>Filter by trait</strong>. After filtering, you can click each colored dots to get more detail information about the significant associations.</p>
    </blockquote>
  </li>
  <li>Click on <strong>Search</strong>, let’s search <strong>height</strong> for the analysis.
    <blockquote>
      <p>There are several ways of searching:</p>

      <ul>
        <li>Enter a disease name: ex. <code class="highlighter-rouge">breast cancer</code></li>
        <li>Enter a genome region: ex. <code class="highlighter-rouge">6:16000000-25000000</code>, read as chr:start-stop.</li>
        <li>Enter a SNP name: ex. <code class="highlighter-rouge">rs7329174</code>.</li>
      </ul>
    </blockquote>
  </li>
  <li>Become familiar with association information you can get from a search.
    <blockquote>
      <p>Note these features:</p>

      <ul>
        <li><strong>SNP name</strong></li>
        <li><strong>RAF</strong>: Risk/effect allele frequency in controls</li>
        <li><strong>P-value</strong></li>
        <li><strong>OR</strong>: Odds ratio associate with SNP</li>
        <li><strong>Beta</strong>: Beta coefficient associte with increase or decrease of the SNP</li>
        <li><strong>CI</strong>: 95% confidence interval</li>
        <li><strong>Region</strong>: cytogenetics region of SNP</li>
        <li><strong>Location</strong>: chr:start-end</li>
        <li><strong>Functional class</strong></li>
        <li><strong>Reported/mapped gene</strong></li>
      </ul>
    </blockquote>
  </li>
  <li>Understand individual associated SNPs (select SNPs with effectSize &gt;2).
    <blockquote>
      <p>click the <strong>arrow</strong> right next to the SNP name, it will go to individual SNP association page.
click <strong>Genomic context</strong>, it is the similar genome browser you learned previous week, play around the different track and see what kind of information you can find.</p>
    </blockquote>
  </li>
  <li>Understand the SNP effects on gene regulation.
    <blockquote>
      <p>click on <strong>Genes and gene regulation</strong>, and find the consequence of the transcripts, either a coding transcript or non-coding transcript, does this SNP will lead to non-sense mediate decay (MND)? Which tissue has the biggest effect of this SNP on the gene expression?</p>
    </blockquote>
  </li>
  <li>Understand the population genetics of SNPs.
    <blockquote>
      <p>click <strong>Population genetics</strong> and check the allele frequency in different population, does certain population have high risk for this SNP? Below 1000 Genomes Project Phase 3 allele frequencies there is bar chart for the allele frequency in five major populations (African, American, European, South Asian, East Asian). Below there is more defined populations within these five major populations.</p>
    </blockquote>
  </li>
  <li>Understand linkage disequilibrium.
    <blockquote>
      <p>click <strong>Linkage disequilibrium</strong>, and view the <strong>LD Manhattan plot</strong> and <strong>LD heatmap plot</strong> by click <strong>View plot</strong> of LD plot. Check the heatmap in each population (eg. African, American, European, South Asian).</p>
    </blockquote>
  </li>
  <li>Understand Phylogenetic contexts.
    <blockquote>
      <p>click <strong>Phylogenetic contexts</strong> and see what is conservation level across different species. click you can choose 8 primate, 21 eutherian mammals, 27 amniota vertebrates, and 53 eutherian mammals.</p>

      <ul>
        <li>Note: Not every species has a sequence alignments, some loci only have sequence alignments in primates.</li>
      </ul>
    </blockquote>
  </li>
  <li>Understand the global pattern of assocation SNPs in R.
    <blockquote>
      <p>After you search the disease you want to study, click <strong>Download association results</strong> to download entire association SNPs. Save the file on your desktop.</p>
    </blockquote>
  </li>
</ol>

<p>load the library</p>

<div class="highlighter-rouge"><pre class="highlight"><code>library(readr)
library(dplyr)
library(ggplot2)
</code></pre>
</div>

<p>change directory</p>

<div class="highlighter-rouge"><pre class="highlight"><code>setwd('~/Desktop')
</code></pre>
</div>

<p>read the file</p>

<div class="highlighter-rouge"><pre class="highlight"><code>snps &lt;- read_delim("~/Desktop/downloads.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
</code></pre>
</div>

<p>check column name</p>

<div class="highlighter-rouge"><pre class="highlight"><code>colnames(snps)
</code></pre>
</div>

<p>identify the SNP with the largest OR or Beta effect size</p>

<div class="highlighter-rouge"><pre class="highlight"><code>colnames(snps)[31] &lt;- 'effectSize'
biggest_effect_size &lt;- max(snps$effectSize, na.rm = TRUE)
filter(snps, effectSize == biggest_effect_size)
</code></pre>
</div>

<p>look at the distribution of OR or Beta effect size</p>

<div class="highlighter-rouge"><pre class="highlight"><code>histogram(snps$effectSize, na.rm = TRUE, breaks=100)
</code></pre>
</div>

<p>identify the SNPs with OR or Beta effect size &gt;2</p>

<div class="highlighter-rouge"><pre class="highlight"><code>filter(snps, effectSize &gt; 2)
nrow(filter(snps, effectSize &gt; 2))
</code></pre>
</div>

<p>count the frequncy of SNP context and make barplot</p>

<div class="highlighter-rouge"><pre class="highlight"><code>counts &lt;- as.data.frame(table(snps$CONTEXT))
colnames(counts)[1] &lt;- 'context'
colnames(counts)[2] &lt;- 'count'
counts &lt;- mutate(counts, frequency = count/sum(counts$count))

ggplot(counts, aes(x=context, y=frequency)) +
  geom_bar(stat="identity") +
  xlab("Context of SNPs") +
  ylab("Counts") +
  theme(axis.text.x=element_text(angle=45,hjust=1,size=10))
</code></pre>
</div>

<h2 id="assignment">Assignment</h2>

<p>Answer the following questions:</p>

<ol>
  <li>Select one disease you want to study (make sure that disease has at least 50 association SNPs?</li>
  <li>See the distribution of the SNPs on the genome for certain disease.</li>
  <li>Familiar with the output of the SNP associations in the GWAS Catalog.</li>
  <li>What kind of gene regulation consequences in your assocation SNPs?</li>
  <li>Does LD around the assocation SNPs is different among populations by visualizing LD heatmap?</li>
  <li>Does certain population has high risk for the disease you study?</li>
  <li>What is the phylogenetic conservation in the association SNPs?</li>
  <li>Use R code to select the SNP which has the biggest effect (OR or Beta).</li>
  <li>What the disease you study what is the distribution of different association SNP context?</li>
</ol>

</div>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/BIT150_website/2017/11/30/lab-09/">
            Lab 9 - Genome Annotation
            <small>30 Nov 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/BIT150_website/2017/11/16/lab-08/">
            Lab 8 - Genome Assembly
            <small>16 Nov 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/BIT150_website/2017/11/02/lab-06/">
            Lab 6 - Genome Browsers
            <small>02 Nov 2017</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
